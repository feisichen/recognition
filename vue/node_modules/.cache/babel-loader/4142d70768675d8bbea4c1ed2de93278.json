{"ast":null,"code":"import PDFJS from 'pdfjs-dist';\nexport default {\n  name: 'pdf',\n  props: ['pdfurl'],\n\n  data() {\n    return {\n      pdfDoc: null,\n      //pdfjs 生成的对象\n      pageNum: 1,\n      //\n      pageRendering: false,\n      pageNumPending: null,\n      scale: 1,\n      //放大倍数\n      page_num: 0,\n      //当前页数\n      page_count: 0,\n      //总页数\n      maxscale: 2,\n      //最大放大倍数\n      minscale: 0.8 //最小放大倍数\n\n    };\n  },\n\n  methods: {\n    renderPage(num) {\n      //渲染pdf\n      let vm = this;\n      this.pageRendering = true;\n      let canvas = document.getElementById('the-canvas'); // Using promise to fetch the page\n\n      this.pdfDoc.getPage(num).then(function (page) {\n        let viewport = page.getViewport(vm.scale); //alert(vm.canvas.height)\n\n        canvas.height = viewport.height;\n        canvas.width = viewport.width; // Render PDF page into canvas context\n\n        let renderContext = {\n          canvasContext: vm.ctx,\n          viewport: viewport\n        };\n        let renderTask = page.render(renderContext); // Wait for rendering to finish\n\n        renderTask.promise.then(function () {\n          vm.pageRendering = false;\n\n          if (vm.pageNumPending !== null) {\n            // New page rendering is pending\n            vm.renderPage(vm.pageNumPending);\n            vm.pageNumPending = null;\n          }\n        });\n      });\n      vm.page_num = vm.pageNum;\n    },\n\n    addscale() {\n      //放大\n      if (this.scale >= this.maxscale) {\n        return;\n      }\n\n      this.scale += 0.1;\n      this.queueRenderPage(this.pageNum);\n    },\n\n    minus() {\n      //缩小\n      if (this.scale <= this.minscale) {\n        return;\n      }\n\n      this.scale -= 0.1;\n      this.queueRenderPage(this.pageNum);\n    },\n\n    prev() {\n      //上一页\n      let vm = this;\n\n      if (vm.pageNum <= 1) {\n        return;\n      }\n\n      vm.pageNum--;\n      vm.queueRenderPage(vm.pageNum);\n    },\n\n    next() {\n      //下一页\n      let vm = this;\n\n      if (vm.pageNum >= vm.page_count) {\n        return;\n      }\n\n      vm.pageNum++;\n      vm.queueRenderPage(vm.pageNum);\n    },\n\n    closepdf() {\n      //关闭PDF\n      this.$emit('closepdf');\n    },\n\n    queueRenderPage(num) {\n      if (this.pageRendering) {\n        this.pageNumPending = num;\n      } else {\n        this.renderPage(num);\n      }\n    }\n\n  },\n  computed: {\n    ctx() {\n      let id = document.getElementById('the-canvas');\n      return id.getContext('2d');\n    }\n\n  },\n\n  mounted() {\n    let vm = this;\n    PDFJS.getDocument(vm.pdfurl).then(function (pdfDoc_) {\n      //初始化pdf\n      vm.pdfDoc = pdfDoc_;\n      vm.page_count = vm.pdfDoc.numPages;\n      vm.renderPage(vm.pageNum);\n    });\n  }\n\n};","map":{"version":3,"mappings":"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","names":["PDFJS","name","props","data","pdfDoc","pageNum","pageRendering","pageNumPending","scale","page_num","page_count","maxscale","minscale","methods","renderPage","num","vm","canvas","document","getElementById","getPage","then","page","viewport","getViewport","height","width","renderContext","canvasContext","ctx","renderTask","render","promise","addscale","queueRenderPage","minus","prev","next","closepdf","$emit","computed","id","getContext","mounted","getDocument","pdfurl","pdfDoc_","numPages"],"sourceRoot":"","sources":["E:\\code\\springboot+vue\\class_choose_book1\\vue\\src\\components\\Pdf.vue"],"sourcesContent":["<template>\r\n  <div class=\"pdf\" id=\"pdf\">\r\n    <top-normal-bar normalTitle=\"合同查看\"></top-normal-bar>\r\n    <div class=\"center\">\r\n      <div class=\"contor\">\r\n        <button @click=\"prev\">上一页</button>\r\n        <button @click=\"next\">下一页</button>\r\n        <span>Page: <span v-text=\"page_num\"></span> / <span v-text=\"page_count\"></span></span>\r\n\r\n        <button @click=\"addscale\">加</button>\r\n        <button @click=\"minus\">减</button>\r\n        <button id=\"prev\" @click=\"closepdf\">关闭</button>\r\n      </div>\r\n      <canvas class=\"canvasstyle\" id=\"the-canvas\"></canvas>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport PDFJS from 'pdfjs-dist'\r\n\r\nexport default {\r\n  name: 'pdf',\r\n  props: ['pdfurl'],\r\n  data() {\r\n    return {\r\n      pdfDoc: null, //pdfjs 生成的对象\r\n      pageNum: 1,//\r\n      pageRendering: false,\r\n      pageNumPending: null,\r\n      scale: 1,//放大倍数\r\n      page_num: 0,//当前页数\r\n      page_count: 0,//总页数\r\n      maxscale: 2,//最大放大倍数\r\n      minscale: 0.8//最小放大倍数\r\n    }\r\n  },\r\n  methods: {\r\n    renderPage(num) { //渲染pdf\r\n      let vm = this;\r\n      this.pageRendering = true;\r\n      let canvas = document.getElementById('the-canvas')\r\n      // Using promise to fetch the page\r\n      this.pdfDoc.getPage(num).then(function (page) {\r\n        let viewport = page.getViewport(vm.scale);\r\n        //alert(vm.canvas.height)\r\n        canvas.height = viewport.height;\r\n        canvas.width = viewport.width;\r\n\r\n        // Render PDF page into canvas context\r\n        let renderContext = {\r\n          canvasContext: vm.ctx,\r\n          viewport: viewport\r\n        };\r\n        let renderTask = page.render(renderContext);\r\n\r\n        // Wait for rendering to finish\r\n        renderTask.promise.then(function () {\r\n          vm.pageRendering = false;\r\n          if (vm.pageNumPending !== null) {\r\n            // New page rendering is pending\r\n            vm.renderPage(vm.pageNumPending);\r\n            vm.pageNumPending = null;\r\n          }\r\n        });\r\n      });\r\n      vm.page_num = vm.pageNum;\r\n\r\n    },\r\n    addscale() {//放大\r\n      if (this.scale >= this.maxscale) {\r\n        return\r\n      }\r\n      this.scale += 0.1;\r\n      this.queueRenderPage(this.pageNum)\r\n    },\r\n    minus() {//缩小\r\n      if (this.scale <= this.minscale) {\r\n        return\r\n      }\r\n      this.scale -= 0.1;\r\n      this.queueRenderPage(this.pageNum)\r\n    },\r\n    prev() {//上一页\r\n      let vm = this\r\n      if (vm.pageNum <= 1) {\r\n        return;\r\n      }\r\n      vm.pageNum--;\r\n      vm.queueRenderPage(vm.pageNum);\r\n    },\r\n    next() {//下一页\r\n      let vm = this;\r\n      if (vm.pageNum >= vm.page_count) {\r\n        return;\r\n      }\r\n      vm.pageNum++;\r\n      vm.queueRenderPage(vm.pageNum);\r\n    },\r\n    closepdf() {//关闭PDF\r\n      this.$emit('closepdf')\r\n    },\r\n    queueRenderPage(num) {\r\n      if (this.pageRendering) {\r\n        this.pageNumPending = num;\r\n      } else {\r\n        this.renderPage(num);\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ctx() {\r\n      let id = document.getElementById('the-canvas')\r\n      return id.getContext('2d');\r\n    }\r\n  },\r\n  mounted() {\r\n    let vm = this;\r\n    PDFJS.getDocument(vm.pdfurl).then(function (pdfDoc_) { //初始化pdf\r\n      vm.pdfDoc = pdfDoc_;\r\n      vm.page_count = vm.pdfDoc.numPages;\r\n      vm.renderPage(vm.pageNum);\r\n    });\r\n  }\r\n}\r\n\r\n</script>\r\n<style>\r\n.pdf {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  background-color: rgba(0, 0, 0, .5);\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 99999;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.center {\r\n  text-align: center;\r\n  height: 100%;\r\n  overflow: auto;\r\n  padding-top: 20px;\r\n}\r\n\r\n.contor {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}