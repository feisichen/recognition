{"ast":null,"code":"import { ArrowLeft } from '@element-plus/icons-vue';\nimport request from \"@/utils/request\";\nimport * as echarts from \"echarts\";\nexport default {\n  name: \"TeacherGrade\",\n\n  data() {\n    return {\n      ArrowLeft,\n      id: sessionStorage.getItem(\"id\"),\n      courseId: sessionStorage.getItem(\"currentCourse\"),\n      courseName: sessionStorage.getItem(\"currentCourseName\"),\n      teacherId: sessionStorage.getItem(\"currentId\"),\n      teacherName: sessionStorage.getItem(\"currentName\"),\n      term: sessionStorage.getItem(\"currentTerm\"),\n      time: sessionStorage.getItem(\"currentTime\"),\n      weight: sessionStorage.getItem(\"currentWeight\"),\n      credit: sessionStorage.getItem(\"currentCredit\"),\n      limitNum: sessionStorage.getItem(\"currentLimitNum\"),\n      currentNum: sessionStorage.getItem(\"currentCurrentNum\"),\n      checked: false,\n      tableData: [],\n      grade1: null,\n      grade2: null,\n      row: {},\n      badGrade: false,\n      disagreeGrade: false\n    };\n  },\n\n  created() {\n    this.load();\n  },\n\n  methods: {\n    checkchange() {\n      console.log(this.tableData);\n    },\n\n    load() {\n      request.get(\"/grade/forGrade\", {\n        params: {\n          term: this.term,\n          courseId: this.courseId,\n          teacherId: this.teacherId,\n          time: this.time\n        }\n      }).then(res => {\n        console.log(res);\n        this.tableData = res.data.list;\n        this.total = res.data.total;\n      });\n    },\n\n    save() {\n      this.badGrade = false;\n      this.disagreeGrade = false;\n      request.get(\"/grade/usualGradeCheck\", {\n        params: {\n          term: this.term,\n          courseId: this.courseId,\n          teacherId: this.teacherId,\n          time: this.time\n        }\n      }).then(res => {\n        // console.log(res);\n        if (res.code === '0') {\n          let index = 0;\n          let isvalid = true;\n          let isequal = true;\n\n          for (index = 0; index < this.tableData.length; index++) {\n            if (this.tableData[index].checked === false || this.tableData[index].checked === undefined) {\n              if (this.tableData[index].grade1 !== this.tableData[index].grade2) {\n                isequal = false;\n              }\n\n              if (!(this.tableData[index].grade1 <= 100 || this.tableData[index].grade1 >= 0 || this.tableData[index].grade2 <= 100 || this.tableData[index].grade2 >= 0) || this.tableData[index].grade1 === undefined || this.tableData[index].grade2 === undefined) {\n                isvalid = false;\n              }\n            } else {\n              this.tableData[index].grade1 = -1;\n            }\n          }\n\n          if (isvalid === true && isequal === true) {\n            for (index = 0; index < this.tableData.length; index++) {\n              request.get(\"/grade/usualGrade\", {\n                params: {\n                  term: this.term,\n                  courseId: this.courseId,\n                  teacherId: this.teacherId,\n                  time: this.time,\n                  studentId: this.tableData[index].id,\n                  grade: this.tableData[index].grade1\n                }\n              }).then(res => {});\n            }\n\n            this.$message({\n              type: 'success',\n              message: '平时成绩提交成功'\n            });\n          } else if (isvalid === false) {\n            this.badGrade = true;\n          } else if (isequal === false) {\n            this.disagreeGrade = true;\n          }\n        } else {\n          this.$message({\n            type: 'error',\n            message: res.msg\n          });\n        }\n      });\n    },\n\n    back() {\n      this.$router.push('/teacherGrade');\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA+DA,SAAQA,SAAR,QAAwB,yBAAxB;AACA,OAAOC,OAAP,MAAoB,iBAApB;AACA,OAAO,KAAKC,OAAZ,MAAyB,SAAzB;AAEA,eAAe;AACbC,MAAI,EAAE,cADO;;AAEbC,MAAI,GAAG;AACL,WAAO;AACLJ,eADK;AAELK,QAAE,EAAEC,cAAc,CAACC,OAAf,CAAuB,IAAvB,CAFC;AAGLC,cAAQ,EAAEF,cAAc,CAACC,OAAf,CAAuB,eAAvB,CAHL;AAILE,gBAAU,EAAEH,cAAc,CAACC,OAAf,CAAuB,mBAAvB,CAJP;AAKLG,eAAS,EAAEJ,cAAc,CAACC,OAAf,CAAuB,WAAvB,CALN;AAMLI,iBAAW,EAAEL,cAAc,CAACC,OAAf,CAAuB,aAAvB,CANR;AAOLK,UAAI,EAAEN,cAAc,CAACC,OAAf,CAAuB,aAAvB,CAPD;AAQLM,UAAI,EAAEP,cAAc,CAACC,OAAf,CAAuB,aAAvB,CARD;AASLO,YAAM,EAAER,cAAc,CAACC,OAAf,CAAuB,eAAvB,CATH;AAULQ,YAAM,EAAET,cAAc,CAACC,OAAf,CAAuB,eAAvB,CAVH;AAWLS,cAAQ,EAAEV,cAAc,CAACC,OAAf,CAAuB,iBAAvB,CAXL;AAYLU,gBAAU,EAAEX,cAAc,CAACC,OAAf,CAAuB,mBAAvB,CAZP;AAcLW,aAAO,EAAE,KAdJ;AAeLC,eAAS,EAAE,EAfN;AAgBLC,YAAM,EAAE,IAhBH;AAiBLC,YAAM,EAAE,IAjBH;AAkBLC,SAAG,EAAE,EAlBA;AAmBLC,cAAQ,EAAE,KAnBL;AAoBLC,mBAAa,EAAE;AApBV,KAAP;AAsBD,GAzBY;;AA0BbC,SAAO,GAAG;AACR,SAAKC,IAAL;AACD,GA5BY;;AA6BbC,SAAO,EAAE;AACPC,eAAW,GAAE;AACXC,aAAO,CAACC,GAAR,CAAY,KAAKX,SAAjB;AACD,KAHM;;AAIPO,QAAI,GAAG;AACLzB,aAAO,CAAC8B,GAAR,CAAY,iBAAZ,EAA+B;AAC7BC,cAAM,EAAE;AACNpB,cAAI,EAAE,KAAKA,IADL;AAENJ,kBAAQ,EAAE,KAAKA,QAFT;AAGNE,mBAAS,EAAE,KAAKA,SAHV;AAING,cAAI,EAAE,KAAKA;AAJL;AADqB,OAA/B,EAOGoB,IAPH,CAOQC,GAAE,IAAK;AACbL,eAAO,CAACC,GAAR,CAAYI,GAAZ;AACA,aAAKf,SAAL,GAAiBe,GAAG,CAAC9B,IAAJ,CAAS+B,IAA1B;AACA,aAAKC,KAAL,GAAaF,GAAG,CAAC9B,IAAJ,CAASgC,KAAtB;AACD,OAXD;AAYD,KAjBM;;AAkBPC,QAAI,GAAG;AACL,WAAKd,QAAL,GAAgB,KAAhB;AACA,WAAKC,aAAL,GAAqB,KAArB;AACAvB,aAAO,CAAC8B,GAAR,CAAY,wBAAZ,EAAsC;AACpCC,cAAM,EAAE;AACNpB,cAAI,EAAC,KAAKA,IADJ;AAENJ,kBAAQ,EAAC,KAAKA,QAFR;AAGNE,mBAAS,EAAC,KAAKA,SAHT;AAING,cAAI,EAAC,KAAKA;AAJJ;AAD4B,OAAtC,EAOGoB,IAPH,CAOQC,GAAE,IAAK;AACb;AACA,YAAIA,GAAG,CAACI,IAAJ,KAAa,GAAjB,EAAsB;AACpB,cAAIC,KAAK,GAAC,CAAV;AACA,cAAIC,OAAM,GAAI,IAAd;AACA,cAAIC,OAAM,GAAI,IAAd;;AACA,eAAIF,KAAK,GAAC,CAAV,EAAYA,KAAI,GAAI,KAAKpB,SAAL,CAAeuB,MAAnC,EAA0CH,KAAK,EAA/C,EAAkD;AAChD,gBAAG,KAAKpB,SAAL,CAAeoB,KAAf,EAAsBrB,OAAtB,KAAkC,KAAlC,IAA2C,KAAKC,SAAL,CAAeoB,KAAf,EAAsBrB,OAAtB,KAAkCyB,SAAhF,EAA0F;AACxF,kBAAG,KAAKxB,SAAL,CAAeoB,KAAf,EAAsBnB,MAAtB,KAAiC,KAAKD,SAAL,CAAeoB,KAAf,EAAsBlB,MAA1D,EAAiE;AAC/DoB,uBAAM,GAAI,KAAV;AACF;;AACA,kBAAG,EAAE,KAAKtB,SAAL,CAAeoB,KAAf,EAAsBnB,MAAtB,IAAgC,GAAhC,IAAuC,KAAKD,SAAL,CAAeoB,KAAf,EAAsBnB,MAAtB,IAAgC,CAAvE,IAA2E,KAAKD,SAAL,CAAeoB,KAAf,EAAsBlB,MAAtB,IAAgC,GAA3G,IAAkH,KAAKF,SAAL,CAAeoB,KAAf,EAAsBlB,MAAtB,IAAgC,CAApJ,KAA0J,KAAKF,SAAL,CAAeoB,KAAf,EAAsBnB,MAAtB,KAAiCuB,SAA3L,IAAwM,KAAKxB,SAAL,CAAeoB,KAAf,EAAsBlB,MAAtB,KAAiCsB,SAA5O,EAAsP;AACpPH,uBAAM,GAAI,KAAV;AACF;AACD,aAPD,MAOK;AACH,mBAAKrB,SAAL,CAAeoB,KAAf,EAAsBnB,MAAtB,GAA+B,CAAC,CAAhC;AACF;AACF;;AACA,cAAGoB,OAAM,KAAM,IAAZ,IAAoBC,OAAM,KAAM,IAAnC,EAAwC;AACtC,iBAAIF,KAAK,GAAC,CAAV,EAAYA,KAAI,GAAI,KAAKpB,SAAL,CAAeuB,MAAnC,EAA0CH,KAAK,EAA/C,EAAkD;AAChDtC,qBAAO,CAAC8B,GAAR,CAAY,mBAAZ,EAAiC;AAC/BC,sBAAM,EAAE;AACNpB,sBAAI,EAAC,KAAKA,IADJ;AAENJ,0BAAQ,EAAC,KAAKA,QAFR;AAGNE,2BAAS,EAAC,KAAKA,SAHT;AAING,sBAAI,EAAC,KAAKA,IAJJ;AAKN+B,2BAAS,EAAC,KAAKzB,SAAL,CAAeoB,KAAf,EAAsBlC,EAL1B;AAMNwC,uBAAK,EAAC,KAAK1B,SAAL,CAAeoB,KAAf,EAAsBnB;AANtB;AADuB,eAAjC,EASGa,IATH,CASQC,GAAE,IAAK,CACd,CAVD;AAWF;;AACA,iBAAKY,QAAL,CAAc;AACZC,kBAAI,EAAE,SADM;AAEZC,qBAAO,EAAE;AAFG,aAAd;AAIF,WAlBA,MAmBK,IAAGR,OAAM,KAAM,KAAf,EAAqB;AACxB,iBAAKjB,QAAL,GAAgB,IAAhB;AACF,WAFK,MAGA,IAAGkB,OAAM,KAAM,KAAf,EAAqB;AACxB,iBAAKjB,aAAL,GAAqB,IAArB;AACF;AACF,SAzCA,MAyCO;AACL,eAAKsB,QAAL,CAAc;AACZC,gBAAI,EAAE,OADM;AAEZC,mBAAO,EAAEd,GAAG,CAACe;AAFD,WAAd;AAIF;AACD,OAxDD;AAyDD,KA9EM;;AAgFPC,QAAI,GAAG;AACL,WAAKC,OAAL,CAAaC,IAAb,CAAkB,eAAlB;AACF;;AAlFO;AA7BI,CAAf","names":["ArrowLeft","request","echarts","name","data","id","sessionStorage","getItem","courseId","courseName","teacherId","teacherName","term","time","weight","credit","limitNum","currentNum","checked","tableData","grade1","grade2","row","badGrade","disagreeGrade","created","load","methods","checkchange","console","log","get","params","then","res","list","total","save","code","index","isvalid","isequal","length","undefined","studentId","grade","$message","type","message","msg","back","$router","push"],"sourceRoot":"","sources":["D:\\code\\Java\\class_choose\\vue\\src\\views\\UsualGrade.vue"],"sourcesContent":["<template>\r\n  <div style=\"margin: 10px;\">\r\n    <el-button type=\"primary\" plain :icon=\"ArrowLeft\"\r\n               @click=\"back\">返回\r\n    </el-button>\r\n    <div style=\"text-align: center;\">\r\n      <h1 style=\"color: #409EFF;\">学生名单</h1>\r\n      <span >\r\n        课程号：<ins style=\"color: ;\">&nbsp;{{ id }}&nbsp;</ins>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n        课程名：<ins>&nbsp;{{ courseName }}&nbsp;</ins>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n        学期：<ins>&nbsp;{{ term }}&nbsp;</ins>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n        <!--        <br><br>-->\r\n        学分：<ins>&nbsp;{{ credit }}&nbsp;</ins>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n        教师号：<ins>&nbsp;{{ teacherId }}&nbsp;</ins>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n        教师名：<ins>&nbsp;{{ teacherName }}&nbsp;</ins>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n        时间：<ins>&nbsp;{{ time }}&nbsp;</ins>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n        考试成绩权重：<ins>&nbsp;{{ weight }}&nbsp;</ins>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n        <!--        <br><br>-->\r\n        选课人数上限：<ins>&nbsp;{{ limitNum }}&nbsp;</ins>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n        当前选课人数：<ins>&nbsp;{{ currentNum }}&nbsp;</ins>\r\n      </span>\r\n      <hr>\r\n\r\n      <!--表格-->\r\n      <el-table :data=\"tableData\" border stripe style=\"width: 100%;\">\r\n        <el-table-column prop=\"id\" label=\"学生学号\" sortable/>\r\n        <el-table-column prop=\"name\" label=\"学生姓名\"/>\r\n        <el-table-column fixed=\"right\" label=\"平时成绩\" width=\"440px\">\r\n          <template #default=\"scope\">\r\n            <el-input v-model=\"scope.row.grade1\" placeholder=\"请输入成绩\"  clearable/>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column fixed=\"right\" label=\"确认平时成绩\" width=\"440px\">\r\n          <template #default=\"scope\">\r\n            <el-input v-model=\"scope.row.grade2\" placeholder=\"请输入成绩\"  clearable/>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column fixed=\"right\" label=\"是否不计平时成绩\" >\r\n          <template #default=\"scope\">\r\n            <el-checkbox v-model=\"scope.row.checked\" @change=\"checkchange\" >不计平时成绩</el-checkbox>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n\r\n    <el-row>\r\n      <el-col :span=\"12\">\r\n        <div style=\"margin: 10px 10px 10px; font-size: 10px; color: rgb(96, 98, 102);\">选课人数：{{ currentNum }}</div>\r\n      </el-col>\r\n      <el-col :span=\"4\">\r\n        <div style=\"margin-top: 15px; margin-left: 20px; color: red;\" v-if=\"badGrade\">输入成绩不合法，请确认！</div>\r\n      </el-col>\r\n      <el-col :span=\"4\">\r\n        <div style=\"margin-top: 15px; margin-left: 20px; color: red;\" v-if=\"disagreeGrade\">两次成绩不一致，请确认！</div>\r\n      </el-col>\r\n      <el-col :span=\"4\">\r\n        <el-button style=\"margin: 10px;\" type=\"primary\" plain @click=\"save\">提交</el-button>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {ArrowLeft} from '@element-plus/icons-vue'\r\nimport request from \"@/utils/request\";\r\nimport * as echarts from \"echarts\";\r\n\r\nexport default {\r\n  name: \"TeacherGrade\",\r\n  data() {\r\n    return {\r\n      ArrowLeft,\r\n      id: sessionStorage.getItem(\"id\"),\r\n      courseId: sessionStorage.getItem(\"currentCourse\"),\r\n      courseName: sessionStorage.getItem(\"currentCourseName\"),\r\n      teacherId: sessionStorage.getItem(\"currentId\"),\r\n      teacherName: sessionStorage.getItem(\"currentName\"),\r\n      term: sessionStorage.getItem(\"currentTerm\"),\r\n      time: sessionStorage.getItem(\"currentTime\"),\r\n      weight: sessionStorage.getItem(\"currentWeight\"),\r\n      credit: sessionStorage.getItem(\"currentCredit\"),\r\n      limitNum: sessionStorage.getItem(\"currentLimitNum\"),\r\n      currentNum: sessionStorage.getItem(\"currentCurrentNum\"),\r\n\r\n      checked: false,\r\n      tableData: [],\r\n      grade1: null,\r\n      grade2: null,\r\n      row: {},\r\n      badGrade: false,\r\n      disagreeGrade: false\r\n    }\r\n  },\r\n  created() {\r\n    this.load();\r\n  },\r\n  methods: {\r\n    checkchange(){\r\n      console.log(this.tableData);\r\n    },\r\n    load() {\r\n      request.get(\"/grade/forGrade\", {\r\n        params: {\r\n          term: this.term,\r\n          courseId: this.courseId,\r\n          teacherId: this.teacherId,\r\n          time: this.time\r\n        }\r\n      }).then(res => {\r\n        console.log(res);\r\n        this.tableData = res.data.list;\r\n        this.total = res.data.total;\r\n      })\r\n    },\r\n    save() {\r\n      this.badGrade = false;\r\n      this.disagreeGrade = false;\r\n      request.get(\"/grade/usualGradeCheck\", {\r\n        params: {\r\n          term:this.term,\r\n          courseId:this.courseId,\r\n          teacherId:this.teacherId,\r\n          time:this.time\r\n        }\r\n      }).then(res => {\r\n        // console.log(res);\r\n        if (res.code === '0') {\r\n          let index=0;\r\n          let isvalid = true;\r\n          let isequal = true;\r\n          for(index=0;index < this.tableData.length;index++){\r\n            if(this.tableData[index].checked === false || this.tableData[index].checked === undefined){\r\n              if(this.tableData[index].grade1 !== this.tableData[index].grade2){\r\n                isequal = false;\r\n              }\r\n              if(!(this.tableData[index].grade1 <= 100 || this.tableData[index].grade1 >= 0 ||this.tableData[index].grade2 <= 100 || this.tableData[index].grade2 >= 0) || this.tableData[index].grade1 === undefined || this.tableData[index].grade2 === undefined){\r\n                isvalid = false;\r\n              }\r\n            }else{\r\n              this.tableData[index].grade1 = -1\r\n            }\r\n          }\r\n          if(isvalid === true && isequal === true){\r\n            for(index=0;index < this.tableData.length;index++){\r\n              request.get(\"/grade/usualGrade\", {\r\n                params: {\r\n                  term:this.term,\r\n                  courseId:this.courseId,\r\n                  teacherId:this.teacherId,\r\n                  time:this.time,\r\n                  studentId:this.tableData[index].id,\r\n                  grade:this.tableData[index].grade1\r\n                }\r\n              }).then(res => {\r\n              })\r\n            }\r\n            this.$message({\r\n              type: 'success',\r\n              message: '平时成绩提交成功'\r\n            })\r\n          }\r\n          else if(isvalid === false){\r\n            this.badGrade = true;\r\n          }\r\n          else if(isequal === false){\r\n            this.disagreeGrade = true;\r\n          }\r\n        } else {\r\n          this.$message({\r\n            type: 'error',\r\n            message: res.msg\r\n          })\r\n        }\r\n      })\r\n    },\r\n\r\n    back() {\r\n      this.$router.push('/teacherGrade');\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}